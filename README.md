# Foodgram - Продуктовый помощник

## Статус
Состояние рабочего процесса:
![example workflow](https://github.com/k-irill-c/foodgram-project-react/actions/workflows/main_food.yml/badge.svg)

## Стек технологий
Backend проекта написан на Django, Python
Так же применялись: Docker, Dockerhub, PostgreSQL, Yandex.Cloud, Workflow

### Django 
Высокоуровневый Python веб-фреймворк, который позволяет быстро создавать безопасные и поддерживаемые веб-сайты.

### Python
Высокоуровневый язык программирования общего назначения с динамической строгой типизацией и автоматическим управлением памятью, ориентированный на повышение производительности разработчика, читаемости кода и его качества, а также на обеспечение переносимости написанных на нём программ. Язык является полностью объектно-ориентированным в том плане, что всё является объектами.

### Docker
Проект с открытым исходным кодом для автоматизации развертывания приложений в виде переносимых автономных контейнеров, выполняемых в облаке или локальной среде.

### Dockerhub
Облачный онлайн-репозиторий, в котором хранятся два типа репозиториев: общедоступный и частный репозиторий. Общедоступные репозитории доступны каждому, но частный доступен заинтересованному владельцу репозиториев.

### PostgreSQL
Реляционная СУБД с открытым кодом и свободным распространением. База данных Postgre базируется на стандартном языке запросов SQL, а точнее, на его расширении — процедурном языке PL/pgSQL.

### Yandex.Cloud
Яндекс.Диск — облачный сервис для хранения фото, видео и других файлов и обмена ими. Диск синхронизирует файлы между облачным хранилищем, смартфоном, компьютером и другими устройствами, проверяет на вирусы, поддерживает двухфакторную идентификацию.

# Workflow
Осуществляет следующие автоматические действия:
* tests - Проверка кода на соответствие стандарту PEP8 (с помощью пакета flake8) и запуск pytest. Дальнейшие шаги выполнятся только если push был в ветку master или main.
* build_and_push_to_docker_hub - Сборка и доставка докер-образов на Docker Hub
* deploy - Автоматический деплой проекта на боевой сервер. Выполняется копирование файлов из репозитория на сервер:
* send_message - Отправка уведомления в Telegram

## Описание проекта

Foodgram - это сайт для рецептов.  
Пользователи могут создавать свои рецепты, читать рецепты других пользователей, подписываться на авторов, добавлять рецепты в избранное, фильтровать рецепты по тегам, а также создавать список покупок и загружать его в pdf формате.


## Локальная установка

* Склонировать репозиторий , перейти в проект:
```bash
git clone https://github.com/k-irill-c/foodgram-project-react
cd foodgram-project-react
```

* Cоздать и активировать виртуальное окружение:

```bash
python -m venv venv
```

```bash
. venv/bin/activate
```

* Перейти в директориию `/infra/` и создать файл `.env` (bash команда: touch .env) с содержанием:

```
SECRET_KEY=<секретный ключ django>
DB_ENGINE=django.db.backends.postgresql
DB_NAME=postgres
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
DB_HOST=db
DB_PORT=5432
```

* Перейти в директирию и установить зависимости из файла requirements.txt:

```bash
cd backend/
pip install -r requirements.txt
```

* Выполнить миграции:

```bash
python manage.py migrate
```

* Запустите сервер:
```bash
python manage.py runserver
```

## Запуск проекта в Docker контейнере
* Установить Docker. sudo apt install docker.io
```bash
apt install docker.io
```  
Параметры запуска описаны в файлах `docker-compose.yml` и `nginx.conf` находящиеся в директории `infra/`.

* Установить docker-compose, с этим Вам поможет официальная документация. https://docs.docker.com/compose/install/ 

* Запустить docker compose:
```bash
docker-compose up -d --build
```  
После сборки появляются 4 контейнера:
1. контейнер базы данных
2. контейнер backend - приложения 
3. контейнер web-сервера 
4. контейнер frontend
  

  Далее следует:
* Применить миграции:
```bash
docker-compose exec backend python manage.py migrate
```
* Создать администратора:
```bash
docker-compose exec backend python manage.py createsuperuser
```
* Соберать статику:
```bash
docker-compose exec backend python manage.py collectstatic --noinput
```
* Загрузить ингредиенты:
```bash
docker-compose exec backend python manage.py load_ingredients
```
* ДЛЯ АДМИНА - Создать в админ-панели(см далее) теги в формате ИМЯ - ЦВЕТ - SLUG:
 
Завтрак - красный - breakfast
Обед - зеленый - lunch
Ужин - фиолетовый - dinner

## Сайт
Сайт доступен по ссылке:
[http://51.250.91.241/](http://51.250.91.241/)

* Создание тегов доступно по адресу: http://51.250.91.241/admin/recipes/tag/

## Документация к API
API документация доступна по ссылке (создана с помощью redoc):
[http://51.250.91.241//api/docs/](http://51.250.91.241//api/docs/)

## Примеры

##### Запрос для получения списка произведений
Отправляем GET-запрос на адрес `http://51.250.91.241/api/recipes/`.
```json
GET http://51.250.91.241/api/recipes/
Content-Type: application/json
```

## Автор backend
Кирилл С. - студент Яндекс-Практикума факультета Python-разработки
